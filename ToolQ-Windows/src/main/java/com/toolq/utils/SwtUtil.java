package com.toolq.utils;

import com.toolq.helper.android.Android;
import com.toolq.resource.TString;
import org.eclipse.swt.SWT;
import org.eclipse.swt.browser.Browser;
import org.eclipse.swt.browser.BrowserFunction;
import org.eclipse.swt.browser.LocationAdapter;
import org.eclipse.swt.browser.LocationEvent;
import org.eclipse.swt.events.MouseAdapter;
import org.eclipse.swt.events.MouseEvent;
import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.graphics.ImageData;
import org.eclipse.swt.layout.FillLayout;
import org.eclipse.swt.widgets.*;

import java.io.ByteArrayInputStream;
import java.io.InputStream;

/**
 * @author luoluo
 * @date 2020/10/17 18:52
 */
public class SwtUtil {
	/**
	 * 废弃的垃圾
	 */
	private static final TString.Couple sms_needed_get = new TString.Couple("是否申请短信验证码", "Whether to apply for SMS verification code");
	private static final String HEX_ICON = "89504E470D0A1A0A0000000D49484452000000C0000000C0080600000052DC6C07000023E94944415478DAED9D07785455FAFF83820ABAA2FFBFBD2C20210901A4EBA234E952A4280AAEF415B0808B05458AACD81B4A0F84F43AE96552210508A12A8AA0AEBBBAAEAE8A288A289032BEBFF73D73279949E6DEB973EF214C92F73CCFF7C96492BCB973EFF773EE39E79EF71C3F3F2E5CB870E1C2850B172E5CB870E1C2850B172E5CB870E1C2850B172E5CB870E1C2850B172E5CB870E1C2850B172E5CB870E1C2850B172E5CB87828002DFC2C960B0717AF6CD93B24A4955ECD3DA0FF7739A60E1D50741E639207C80BC2134DDDF4351F960B177745A9149B160C0EE3D7295D2CEBAFF38FDBDC252826A49B1EF54B0FEF36DE9ADEADB725BC9BDEBFF1248A4531FBA5C7488BD94D893950624C12C51C2639E668ABA5DB3094EC98A3BD88491E202FD4F547D30061E5CA0B84941218B7654840FCE6B501719BCB0263377F855F4FA32A51159E745B4A64C5C4BCD48ABEC991157A7E5F8F7A26858B98FD52A3A5C5EC9AB855C41C981E2B2D66E7F82D151330E690CCF88A4049318330E6D89CE48A11D9891581F85A464C8A332ADB5231C69A24E2EBF81BBAF667142F949137C8236AFE695465B25353E78E8CD88177A64517A3C0AD52A33CEAEEAC44985D648551F855CFEFEBD1F0CC781173AC35495ACCC1E9B122E684DC14693107A446C3ACEDD9705F5E2A7E1F2D25667F8C336D5B264C294817AF65C59C5A90010F1566EA8FE9DE13C5E419775E6A74E64723ACC41A119C543D3137A57A428E779A5364AD7E79FFAEEAD9DBB3BDFE5B354D2FCC1431E717E74A8B39253F43C45CB8A3405ACC7B73D3AA57EDDF59FDD4AE6DD513A5C54CAD5EB1B7B4FAB9DD45D593F0B58C981467C9EEE2EAE57B4A74C79C98936CAB798DBE70F6CAF86CCB3F1A1F044EB7AC7E29D16B7B58C2405105EA8F1E895BC188C6582DB0A4BC18EECE4E04A331EA6A48469C8889275E5A4CAAD52826D5843D12C3A4C4EC9B140ECFEE2E82997817E8699113B30FC6FCFBCE6D30AF380F7A498AD9CB120E8F94E4C3C21D8580FD2B4331BA276E458F08AF88EF6F0DDFB81EADD4A2AEB77C7778D37E902DA8E6A70F816DBB3F50D501B121604664D6A7766D174D0CB3B11CBA23254AC424A864C52433514C824A56CC2EF15B60119A95A0C23E809498C118F351342B41D559524C8A43CDBFF90855B0C9989D6243AA85772237C09D111B5E111090B77CB963AC8CF6B4F84B52F860BA85290054CB38B90C40F302C001017DDE81B1A13068ED5B7793B7DC8D28FA4EED6F2F17DC911A55A2005021CB040C40F303801418BBB9627052240C0BDB508EDE6A25EE04BE781770D4FE9DC2D70DA79EBC02C01F0C0003600E80903F8666C4C3C8982D70D38AA72792C77A87CC6DE58B9D5F02E0C24ED11B372800545327860160004C0200433313AAEFB64442BB55CF4793C714AFF95CF3873ABFAD3A456FDA2300C84D6100180069008CC5BB4087D7561C428FB5115EF3A91121A5F6EFF0D253ED026242BE2600685C97016000A40090115F7D4FB605DABFF9C2B7D7CD9A1C2CEE02737DA819D465E5E48BA8F6BFF9F517FA04C4859C65001800D9008CCF49868EEFBE7AF6BAB9D3EF22AFF92FB8FB629F01C07FC1023A988BDABDB8A41FCDEF104D206B928D016000A40090166B1B8FE7B3E3BBAF545D33FBAF23C86BED67CEBCA4E601D9792E2D9483B9A4DDCA67EFC083AEA4A7A10C0003201D80D52F555D3F73EA28F2DA4D9327B7F635005AFF79E953FD190006E05C0270DDB4FB4793D77C0A00E560DADCBC64D1000680013897005CF5D0E431E4B51BC68D6BE32B005CA00070E9CDCF3E3190016000CE2500D7FEF5BEB1E43505800B180006800138DF002807C3003000E7BE0934F5DE71E4B56B478CB8D4570068E100E0A667160C620018800600E032058016BE04C0650C0003C00030000C4073052068F9A241B72547545202FB9CA26CDB986C8B30AE0CFDB530135E3E50264C202B262599534C4A3897159312EC2926994056CC915909F0D2FE5DF0C48E429A162025E688CC0458BEA7149E292B8261997262D2220394BAB96C4F89782D23E650D443F9E9B6E9788D7AAC7BA3EACF33EFF73D007ACFB503D0EFC5E58326E6A554CEDE6E85970E94D996EC2E16B5A10CBDBCBF0C623F3D2C8C202BE6CABD3B44CC370E964B8BF97C798988B9FA83BDD2622E4693C67CFA11ACFB703F3C2D2926193FFCE82108397C50BC961573F3C7EF43D89143D262D2E75D855E7A0EA11A19B6BEAACB9C9902805BA7F9E01DC07FC9A2417D93222A4789254CB26CD4B4A0268B0C51CD4FE6A7653C64C59C84B7558A39637B96B498A3F1AE4731E716E74A8B4935F48BFB76C2821D0570577A9C94987427A19A9A0C4635AD8C9814878CFF7C79B1A8B965C4BC0BF5607E9A6D1A5E23BA03DC30ED7EEE03701F80FB000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030000C0003C00030004D1E805B13B6C2D3BB8A20F38B7F42E1575FC06B0777C3386B52B30780F282371D7E1F4ABEF90A12FF7944001164F07F347B002825B2A725AC9212A2671466D8C8B454CBCA1025B0530E2FA5317AFBB7B4D33A5DDCB3559560B3D984AAAAABE1A3E3C760ED87FBE1C1C20C69C749E98B749CB38AB2E14E493107A5C5C08ABDA530BF244FECC02E23E6408CB9E9F041F8FEB75335E784F4F3993322A9DF484C3ACF042AE5300F4C93739C54994ECE49B14DDD96095DD7BCEE9B2991BE9E141F71F443A876BAC8CE3AFEFB6FB0118DD0DC92E2438F7C0027CF9E717B4E7EAFAC805710024E8AF77A59946706F54B89AAA4A541E697E6D8A81940CD0B19A2A54B68F5064A60F7E6EF6869166AF2D85400207D79F26798539423E53827E5A68AE3A40476599F9D9A6AD464233350D2BDD978FFD8B7137E5131BF43049BB771E95C2FC50A80EE8063AD16699F7FE6B62CDBECE21CE8B3FEADAA3FCF9CCA7D006FDBBA79FFF9B7E6C5261DF9F107BC85C734F93EC0148C71E2CC698FE7E3ADF7F7701FA0A97482A939E2E982933E3971DC3404BE0C00DD9D8E9FFE5DD7B9A085C818802602402F4BB868E6E8B9F07427A0B5779A1A000FE467C031ECEFE83907B9FFF997301E03D084864127E009FCEFAFBFE832C0A1E3DFC3B0CC84730E40773C3FDD759C23B300506DFECDA95F3D7E6E1A2828FBF66BB83D399287419BE283B0C9F9E9BAEF04077FF80E4666251A068086566985BC59688855FB7641EC671F8B9A75E7FFFE2B00FBF72F270490247A7DE887EFC5CF72BEFC17447F7A587424694C7E04C6E89D146E188069DBB2E02B1DE093F9F77DFF3F189416CB0FC29AF29360EA047EF18B3E080E1CFB5698584F5CAAC9EFC9498697F7EF820F8F1F83FF9CFC05BEFBED149CAEACD4F5BFD48623BFFDED57F8ECC48FF03E0249C3B534C2D62D2154D7314DDF968DC7F1B32EF3EFF9EE1B3CC7F1FC24B8394C85A09A556F73683F42A07627E889B5FDFD785779EFD03ED88BB5A7DE0EA6519151BFFFFD9468A6D050EB44ECD4D2136EB566CF973ACD5F8EE6A707783C15A219CD05A20BF5F5AF2775DF094638F509FAA54489691564C4DF2A2ACEA9E9B5440FB28ABEFE121E29C983BE491135C7775F5E1A7CFEF34FFAFA3BD8F41A6EB0BFC30034F2C97074A17E3A7D5A97513EC026C8BD79A9F0E6FB7BE0536C92549F27D3BB134DEBA07EC58A3DA5D8F7C8147D0A3D7FF7AF9F4F8873CA93E19A2900345787DAD53F9FD10741251ACDE643C637738C477F3A2E9E08F36C509E0E2DD6C9F73435A029893AD523B212783A3403509B0F40C385279B0104647E9A09CAF9000C800B00816274C8AABB39D418F509367B1CE78F016000EA6584D13CA08F7FFCA1C902400FDA68048B016000EA0130CE9A0C877F3CD6A49B3F347275F0D877F8792D0C0003600780123728C946EF83B1A6207A40F670512E3C5E5AC00034670006A44583E5F3A370AAE26CB331BF433F9DFE1DE23FFB58189601688600748EDB22269C9999ABD3D845738DD67F7400BA62738801900040FB258B06754D08AD14FBFAE6A5D908049A1D294334098CF26D2925D06CACDE9670B1A379731AFB57139D8327B162A17362F6BCF6490A87474BF3E1EF3B0BC5D40C19D7BD376A5C56A26D72413A747EF7D5AA6B3929DEFC4EF1E1473F6C96CD1E35D1B9A073C23BC59BBC03745BFECCA08169319513725260E1CE7C1BCD5FA7C41019A2DBEAEA437BC50EEC66E210406C7E7713EBCE8ADDE8CD9C5B9A2B45316845095AC646C675A76570E697E4D8E696E6C16D1BDFA9EAD0B892E2C37CAA0F30383D4E77424C73D417BF9C8041E992126224F52BA80F304CE903F87327D838009444425387ABD9E89ACF09E81CE94DB8E14E7023028092562AABABD8E81E6793568973C500342100688E0F0DF9B1C1F50F8FCED89ECD0034050068388EE6BEB3B1BD13CD89EA630967001A3300B4CAF1EB07CBD9D006F5DADE9D1014C300345A0028D7F57B9D8B41E9C9B4FAFAE42F50F8C5E790F1CFA3F019DE55CEF8C053643A063A964C3C263A363A4659996BB472F4B0E4680888DEC400343600BAC68742D2E747E5B4892B2A20E4837DD033623D740C79472868CBBBF06C713E7C7FEAD47933FF0F68D0E74B0B2128F43DE8B879B550AFC80DB0193BB1BF4B4AD64FFAF463E88231F540C000F81000B42C88AC8E6FEC9143D0890CA698DF594F16E5C2E9F3D0C1A69AFFE9A2BC1AE393FCB7D81510FAAE3866591DE229D9C9D0296C2D04C46C62001A0300B494A0F5CBCFA518E0DB5327618425C2ADF9ED7782F760DFB75F37380007BFFB1F74DEBAA69EF91D1A991489C7FEAB94FF65FDF7A7D0397C1D42B046F34EC000F80800B40EE80949A98D1FFFF03D74C3DA4F0D0052F4E10F1A1C80F8231FAA9A9F746BC43A71EC32FED789D3BFC3F8F478F0DFFA9EE69D8001F0010002633743C4271FC94B22A7E1C0C88D9A00A47D76A4C101C8FCE727AAE6F7C7FE49DFE810D13996F5FF220EBF2FEE00FE78D751838001F001006889BFAF4ECACBEE3A71FA344CC9B4A89ABF2FC2F1C9F186CF23FEECC7E3703B9ADC9DF94953B392C4B1CBFA7FFFF9E5671882CD2A02400D0206C00700A0D99E559217B02AFDEA0BBC0B6CA867FEE0D0F760FDC13D505155755EA62C6C7C7F2F0453AD5C07803E519BA0F4BF5F4A5F7D6E5579490D0002827057081880F30C00CD402C3B071DD24A3478E97FBF80073212E1CE98CD703B1AECEEA4284838FAE1795D1B94863A138E7E04A393A3E12F3121D03F2E14A6645984F92BCF019465DF7C0541D819160084D9D509BF7740C0009C670068B583BADB7ECA14A54FFEEBC48F70F4F8313879C677B2C9E8588E625FE5DF277E3AA7299E746E47A6C4D498BF2E040CC07906E0B9DDC5D29B3F2CD766D0B33BB6D503404010B10E3A2BAB6E3300E709003DBB41B2CC29EF8BCFDD02400A8A5C0FB3B767376F00F0365849CB8DDC979B62EB9B142E1E4AC9D0C8AC0458BCBB488CF2B8FB396DEDF3DD6FA7D8A4E758DF9DFA150626864367AAF15DB41EBA466E80D90519F068491E744F089572DD69C58A511971B68979A9D069F5CBBE09807352FC84BC944ADAD4FAC503BB6CB4F202ED6D254334BA43BBA553CEA9BB9F6FF8E8804F4C4E6BEAA23EC69A03E5F0786176ADB65985166ECF8135FBCA60E3C13DF094A4EBFE24EAC5FD65B667CB8B6184AF27C5F75CFECCA0BB32E22A2921FAA9B2421BAD3A4689F132F4C48E42B17BF982D202B73FDF7AE410A73B3650DAE49643FB617266A2220B4CCEB2EB81AC24F8C7AE2278B9AC18A65A93614A7EBA946B4F0B2C3CBA231FEED8B4BACADFD793E203451F201A26611F80F6D0A25D0D65686846BC5822030173FBF3984F0FB3411B48D158D904D03300A17535A266D08CDC34F85B7E0604D30C52EC13501BDECC75A79C8E61E9B1B6099C14AFDD09A64DEAD89C0DA3BDDF7E239E04D7153D23989E932A000842186878B4137EF5348B9447814C02403B251E9394F8C2F2AC63BF9D826E511BDD03908B0014380160120206400700B483E3495EE6B04177A71C9E125D1F00D10472030029D218040C800E006845B25315BCEA43432EA538093BC02E00A0C935018830060103A00300DADFEB340F8136E8B229D3B0B3EB6C7E4D00229CE425040C800E001E29C987B355BCE85543E96C5525CCDF96ED627E550022DCC80B0818001D00D0AEEDBCEA5BC34EC57EAAA4C0B58953170034B95BF31318249D1030003A0058B1770754F324B8867B1886E77A4559B10100D6BB8A9E153000E601E891B055CC85A7B9FADE686C52142C2DCA8729E9095EFFAD9A8627848B9833B293A07FEC16B8B38EE8BDFE71EE14AAAA410961B0ACA410E6E567C08078FCACEE94A0A5B07A1A640987C5C5F9B070BB55BCEE9F1856A30142E11A8A801E3121EE01C84B430032DD00B0DEBD3C40C000E89D0D1AB551644369E5EED6D56D911BE1B1DC74188606F2E6EFB4742BB68B1FCB4B47B8225D962CD14A6077A431AAA973D81A782C3F13EE4B8F874E5BDF03FFD03ADAAAA535F5453337D1940FE765C043D664080C5FEB3AB5D9CD43AEBA1D5E7722D30B000AEB02B05E030054D4060640C674683A91DE40704E00085707C0BDF93D008006EF4C50A90160C0FC5A001835BF3A001ECC1FA90D0103E0654EB037104807004DAE068051F36B0260D0FC6A0098313F99DD15800DFACDEF0C410C03607A5D20BD1048054031BA3B00CC985F150013E677078059F37B0540A486EADC091800A38BE3EAE8134803C0A9A6AF0B8059F3BB05C0A4F95D01484100D69936BF33000F176641673500223D03D009AF1D0320637F008240654D4F6900D469E73B0320C3FCDE01A0CFFC3500E47B00C00BF3D700909FAE0E802EF36F7081800130BB434CF446BB39CF05006E46796A01889262FE1A000A1C00AC316DFE5A0032E1A11C1500BC34BF1D800D30530D00AFCCAF08AF1D0320638F3015084C01E0C6FC0E001EC79A756C729457439D6AE6770120430D00EFCCEF110003E62793AB0260C4FC8AE8DA0D4D8B693C0004C56DAEEC9F1A0DF7E524DB68E7705AAC4A8668CA336DBE4C996146FEBE73CC2608443305A2D91CBA236A132CC076F0C8847097F73D2A545DBDF0822F44B38E4F8916EBF60B6D25ADD15698BABA514C34D5039989D019010B0A7352B87D1E7E3D45688B12D8E717648927B7B4FE3F6573D5285243684AF7DA085DA337C16CFCEC344F885ED37B42D11E446B0AA92838260446A4C6F87652FC0D4A527CDF17970C1A93935439AD301356ECDB61FBFBCE6DF06849BE142DDF530AE1470FC1B2F212C331E617E5C01C6B2ACCCE4A167A026BEAB5E5A5F0DCF69C9AF73495ADAD39D89E7E149B3FEBF7EC84178A0BC4F776A5BA17654FE5A4A92BD7AE791873C3BE3278655711765C6BDF7F18DFAFAF0C75E567885A9F44E6A704F6B7F6EC807905F6F7E61668A89094554FF3D0EC0E3DB2DD0AABF797C1DA83E5E2B5FD7DABAAE66FD710AD2F84D78BB4747791EDC99D853034746D55D09C697600A6F920003D1180E1D90995530AD2E1B9F222DBBCE23CA0C47819A2DA3FE4F04191176C26CEF4820C78106BD207D313601E9AF09DB26258841798BEF7A80C0FC2B804C2EADD0455AEFDFF645A54F5D72C2D25D9959D0433ACC9F02E1AF585D2427828DBFE1E7DA5214CFD4AB12BC7AE19081F999F12D8298D91DE9B96ABA654BBF29C9506D3EB889A3FAF61CCB7F6EDC2D719301DBFD754819A326A3403AFCD533BF36D0B4AF3610025C5FB2400CE49F14A13E85E6C02F5B28489E5F26488D6032208A82F60365610DE7603B069D20F9B408F63CD3822210C02B0FDAE296CFAA82AB456B48DD202BC68F76013889A5C016AC2668FA6B0E913A8A80B366916606D7B3F4246CD9E40770AF7A4752EA2660FD5FC647E4A600FC4E35655A43B6D106D7E6705637367169A966AFE2E788E83B069E456F4334D6D72D1B0D468DBF89C64F07F7B1577828D6E94EDEE61D9ED7872757582553ABCEEC6F9BBA3B9EC9DE068431D5E770FB9A8DDEFDA09F6AEC3EB6E8893DAFA359DE0BAD95B3A3ABCEE64EF0463330B01A07E81B71D5EC7F0A7B3A8133C2425DA768F35093A3200F20020F5B384A35933B501F0C2FCB50064AA03E0A5F95D014810E6356B7E0700D4B6A7268E2A005E985F0010E5010003E60F6400CE1D0077A444C1A2D2021896102EC5FC020034822A0006CCEF00E0716C024DCEAC038041F3EB02C04BF393C1350130607E06A00100A098A3B06951EF398101F393C9550130687E3B00EBEA0360C2FC64701AD25405C080F9350130687E06A08100B83B3BD1F5619941F3AB0260C2FC64F67A009834BF260006CDAF0A8009F333000D0980F2C4584CA0F3CAFCAECD9C7A009834BFB700E89DD5E9160013E6770B8049F3D703E01D9E0A716E01709E456A3093CB050009E677052051ECCB65D6FC6E013069FE7A00446F346D7E1700729219800601C001011AD4481A630D0029D152CC5F0B40B62600DECEE7AF0520558CEB9B35BF3300733D02A0CFFC3500A432000D0B80784E6087C0DB29CDDDC583B02C18477B694930BF0020421B0023C92C0280423500D61B4A661100142000DBB500D06F7E0140CC26189A1AC300343400CE77026FA634778FF4008081F9FC5A0018CDE4B2039025A635047A93C0AE05001A561B00EFCC4FEB063100E7130047C7D80502ED29CD9A00184C665103C04C1A237552EB0360DCFC9D94290EEA00786F7E06C017007081C0F37C7E55004C6472B903C06C0E6F7D00CC995F1B0063E667007C05004F103819DD2D0026D3189D01089094C05E0B409A98D866D6FCEA0018373F03E04B00A84150A799530F000939BCBA01F02293CB01004D630E3295C0AE06C026D3E667007C0D80BA10B8E9E4BA00202981BD16008BD88B4B46023B0140D39655013090C6A8058011F33B03309E01F011001C1090610D03E0DD946601C036ABD88931405202BB260006737805009439B6DDEA028051F33300BE0A800604DDD14C94BC322E35468AF9ED00AC5707C060023BE5EABA05C044023B25AFD405C08CF91B2500AE1961E1D232C2864BCC087368001E27C51C63B518CB2CA30B44D9586862877AE1457F028D353E35B626A3AB56C632B928819D36A1A67D780986DAC4F7F5EA8A54933D7B8B92D6296F97D21829934BBC1FE5411EB2B8BAC484C0EC6D59228FB70B5612411AC9EE42F83B9E144C7BC0A5D9B749EDE4B3AB423825C58FCC4EACA4CD8D97EC29B1D1CE2DB38BAC52F42C1A75F3C7EF0BC3CA8A493B9153CCA5E5258663CCC20B3EDD9A02D3B293841ECE4D83B57B77C2D2E202FC3EB946D3ADC9E2F7EA29474BA942B3F2D245023B6D424DFBF08AF77353C58A0E6E85B5BA5BA1D9672AA2D51B28819D7278298D91A63068AA404358EB93C8FC6F1E2883D507CB610E5602746ED495ADAAD9DB6B3507B5B86C9BED899D853068F3BBBE9D144F008CB65A2A1FC293B17C6FA96DE18E42985F9C2745B41A44D89143F07C79B1B4988B11268AB972EF0E5371E6220873D060B3D17C8FE6678A151C5E28DD0673F07B7A6F0E9A967EEEAA740FCA8039F97651EEEE8603E522819DF6E0152AD052A6589FD359B4568FB368E9125ABD8112D8A929F4B086686E0F756CD56515A29A9FCCBFEE83BDF048512ECCC3EFD595ABAAF9CE2ACEC56B5E627B72D736B86BCB1A1F05C0CDBA40D404EA4DEB02615341861C4DA0A1D804921573609ABD0934169B40666375C6DB3F354B7A2B4DA00969B1AEEBF7B8ACE3A3A5FA6BFC74733481F00E4309ECDE357BEC4D9ECE7554DB04CA1009ECAAEBFD68AEE9B3C945D4ECA11A9BCCDF4D9C13F7CD9E606F847146A4C7DA26FA7413A8397682553AC63D1080DA4EB09C04F660E74E70C43A2909EC359D606C0E05494A60A7363F356FA88627B37BDBE1D5EC04F3D2888D000054CF84ADB0108D350E3BC132CCEF006001D6D693B33500F0723EBF1D00AB3A000692593A6B0160C0FC3500A431008D06005A0BE949ECFBDC931627C5FC0280480F00184866A1268C2A000633B9540130687E01002F8EDBF800A09813ADC9D212D8A9DDAF0A80C14C2E55004CA431BA05C084F97979F4C60C005EB000EC18FA879BCFE15505C0441AA35B004CE6F0D603C0A4F91980C60E80E389B1C93446B70098CCE1AD07808404761700E8B39B343F03D014005081C09B29CDF5009090C0EE0280A404766700828D02C0BB44364100EA40E0ED7C7E17002425B0EB0740FF94663B00D9E2619621009AC436A97121550C801B0014083A19D8904E0080B5EAE4EC24370018CBE42200681D7E5A8E3C4852023B357B0C03D09837CABE6972BFD67450D73FB3604040ECE6330C800A005A1068CCE8AC01C05A1700E3698C9E01F03E99C530001AE75300901E276683DEF2F64B67AF9A32690C79ED8671BDDBF80C007E83075F825F2FBD76DAC4AE7832FE77675A3403A006808060932B041EA6340747B903C05C0E2F3557D4013096C96508000FE7D301C03DD8FC6BFFCAB263FF6FD89D7F2100FCFA894AD72700B8C0AF4B978B0800D4D5FEE1EB0E32001E0050CCE1712EBF32DA531F00F309ECEA00184F63F41A001DE7533C09CE88B78D4D8B83F62B161F458FDD28BCE6EF7FB1F09E4F00E0E7D7120FE87202A0E38637A3441328279901F0F4FB04818EB93D0E00EEF7048017C92CEE013097C3EB15003ACFA7038091315BE0C6458F6492C714AFB5F42900AEEC7D4B5B3AB81B173F36ED8EA470A05DFDBA276CFD8301D00381F6FAFCB5002423007212D8EB03603E815D37005E9C4F6C02FD413B83DEB5E16DB87AEAA405E4B12B7AB4BFC2970068210EE6DA6BA9097415AA7DEF90D507C66725428F84D04A6F3F70B303C01D0411F5015888A65205C0401A632D0019229B4B46023B0140492CF3B500F0E67CDAE702550E88DE0C7F59F9FC11F45647E1B1ABAFBE4C01A085AF007021AAF5651DAFBD06BFDEECFFC8ACBFDD1D1B0ADDE343A153F4261B03E0050411EE00D8A80E80C11C5E0140517D00CCE4F07A04C0CBF3815F6DF43FFBBEB90A82A74D5948DEBAB4C335D792D714CFF9140097F8B56D7BA55FEBD637E3EB4EFD562D8B0C5EFF066D77FF8780C0E49DA0C903E080C0CD38BF2A002612D8ED00E4B8006036815D130023E6C7E64FFB579641F0C2F916F294F016798CBCE6430038FA01341274B95F9B3637E0D75B505D6F796E515687B757898E1BDDCAA83D17A8CCF10E5486B8F48A32C1688FE0BB10006FFF564DD4597F5A014056CCDE0800C59C44EBEE1BF87B71F1F17C0544D4AA0B659915E7C2030800ADE226DE8FF42034B9BA368A1DD809801985990200C752E4AA725C370D052B196194C648995C5E5DEBDADFFD83BC42C749E6BFE1D15905E425E1A9D6AD6F141EB37BED025F03A09532147AD5256DDB120081A85BBB3CBD30FEF6775F83FE919B60485AACE8D1D7283DCE464FF9F4E8A1FC74DBAA0365B607F3D274FF8D274DCE491131671666498B392E2B51C49C5F92631B66344E6AB46D4852846D88C5AE11C951B615BB8B6C8F6DCBB60DA5F78522B5857FA3A51129D136DA819D36A1A67D7869130A55E1CF292BCB9368F5064A60A71CDE11E273E0FB6931DA9F953C40AAF5050C880A813EAFFD03821E7B38193DD49DBCA478EA2AC563AD7CA5035CBF19E4E747A341D75DFCA73F05E0D7E056AD5A750F7E70CAD3D889F964F0DA376178C446189D1C0D6814A0E5EEE811B71E4DC79AE5B93D25306D7B96EEBFF1A4A958FB51CCD95813CA8A39393F5DC49C5B92672A0E9D1B3A47E332138006149EDE5100F3F01CDC43EF69CAA2297AA0449A604D82453B0B8076601F8F7716DA82C8ADF038B434DE49B47409ADDE4009EC13F57E56F1392D3026350646A0F107AF79036E5BFACCA781F74F5A4CDE210F295EBA4EF196CF357FDCDD05FE3FEA26BF8B2E0A4275A30F82EA7BF5A4B14B6E7C6C4EC1CD8B177CDE6ED9333FDEF2EAF28AF66FACA8EEF0EA8A2A4FBAF5ED5555C336BE53D5EDAD55557A7E5F8F82DF7C51C4ECF9CECBD26206BEB152C4ECB3FAD5AA5B4CC75B5ED56ED5D2AA8E2F2DADBA6BEDEB55B7BD8DC789AFDBA9E9654F5A56A35B5E595E3570ED1B55FDDE7B0D5F2FABEAE04EF8FFBD51473CE6FE789C03D7BD295E7BFA7CED5F5F5E8D1EA86CB762F18FE4891B1E995578F5C4314BD12BB709F3A3778487C84B764FF964ED5FF72E404FE8FE241E5860AFDDEFE28B035A5D7129914C10F444F56AD9B265BFB63DBBDCDB76F8E0BF5D3974E03C3DBA7ED4E0791D478F9A77CDF0C1F3F4FE8D27512C8A79FDA8A1D2625EA5C4BC51624C52C7D1C3959877AAC8FB98ED31E69F251F27C524E9FAFD2103E6B71D32E06FE405F20479833C22BC429E41EF080FD9BDF427C55B3E59FBBB3E13B0DFA62EAF81C0CFCF1F49EE821FAA47AB2BAE20087A386060B1142FD8BD71459B9EE415E1995AF35FAE78AAA52F9BDF01C0057520A08E0B8D0CB51743597E7EA259E47729C2D0B64DAF566DDBF646F5D1A33657E9FB3D6FD49C63B63A5731F5C7ED4D1E402FD89B3BE40DBB47DA2B9EB9AA8EF92FF07500EA4270B198B9E7E74763B7D7281399DAA13A2884D3870D60356B7552BCD041F1C68D8A57AE54BC737163327F5D082E54C66C5B2B6DB82B15AAE9035EAF507E23AB59EB06C50BD728DEB852F14A6BC53B173636F3ABDD0D2E526E65972A645FAE0C6B5DE1A42B59CD42CED7BCADE285CB146F5CA278A56563367E5D089CEF082D95A1AC8B94DBDBC5CA8766353F39AEFF458A275AD6A9F11BBDF9D540B8C0090816CBD9134DCEF87AA060356F71E1C2850B172E5CB870E1C2850B172E5CB870E1C2850B172E5CB870E1C2850B172E5CB870315FFE0FF3178F564A92F20B0000000049454E44AE426082";

	public static Image getImage(Display display, String hex) {
		byte[] by = HexUtil.hexStringToBytes(hex);
		InputStream stream = new ByteArrayInputStream(by);
		ImageData imageData = new ImageData(stream);
		return new Image(display, imageData);
	}

	public static String sms_code(String msg, DeviceLockEvent event) {
		final String[] ret = {null};
		Display display = new Display();
		Shell shell = new Shell(display, SWT.WRAP);
		shell.setImage(getImage(display, HEX_ICON));
		shell.setText(TString.sms_get_code.get());
		shell.setSize(440, 440);
		shell.setLayout(new FillLayout(SWT.VERTICAL));

		Group group = new Group(shell, SWT.NULL);
		group.setBounds(10, 10, 440, 440);
		group.setLayout(new FillLayout(SWT.VERTICAL));

		Label labelText = new Label(group, SWT.FILL);
		labelText.setText(msg);


		Group count = new Group(group, SWT.NULL);
		count.setLayout(new FillLayout(SWT.FILL));

		final Text content = new Text(count, SWT.SINGLE |  SWT.CENTER );
		content.setBounds(0, 0, 380, 10);
		// 多行文本框，可自动换行
		content.addVerifyListener(e -> e.doit = !(!"0123456789".contains(e.text)));
		content.addModifyListener(modifyEvent -> {
			String text = content.getText();
			if(text.length() > 6) content.setText(text.substring(0, 6));
		});

		Button sendButton = new Button(count, SWT.PUSH);
		sendButton.setBounds(0, 0, 60, 50);
		sendButton.addMouseListener(new MouseAdapter() {
			@Override
			public void mouseDown(MouseEvent mouseEvent) {
				super.mouseDown(mouseEvent);
				if(!event.getSMSCode()) {
					try {
						sendButton.setText("验证码获取失败");
						Thread.sleep(1500);
						sendButton.setText("获取验证码");
					} catch (Exception e) {
						e.printStackTrace();
					}
				}
			}
		});
		sendButton.setText("获取验证码");

		Button checkButton = new Button(count, SWT.PUSH);
		checkButton.setBounds(0, 0, 60, 50);
		checkButton.addMouseListener(new MouseAdapter() {
			@Override
			public void mouseDown(MouseEvent mouseEvent) {
				super.mouseDown(mouseEvent);
				String code = content.getText();
				if(code.length() != 6) {
					try {
						checkButton.setText("验证码格式错误");
						Thread.sleep(1500);
						checkButton.setText("提交验证码");
					} catch (Exception e) {
						e.printStackTrace();
					}
				} else {
					event.checkCode(shell, code);
				}
			}
		});
		checkButton.setText("提交验证码");


		count.pack();
		group.pack();

		shell.pack();
		shell.open();

		long st = System.currentTimeMillis();
		while (!shell.isDisposed()) {
			if (!display.readAndDispatch())
				display.sleep();
			else {
				if(System.currentTimeMillis() - st > 1000 * 60 * 2) {
					// 超过一分钟提交验证码请求则关闭
					shell.close();
				}
			}
		}
		display.dispose();
		return ret[0];
	}

	public static String ticket(String input) {
		final String[] ticket = { null };

		Display display = new Display();
		Shell shell = new Shell(display, SWT.TITLE);
		shell.setText(TString.slider_get_ticket.get());
		shell.setSize(440, 440);
		// 宽度 高度
		shell.setImage(getImage(display, HEX_ICON));

		final Browser browser = new Browser(shell, SWT.FILL);
		browser.setBounds(10, 10, 400, 440);
		// xx xx 宽度 高度
		browser.setMenu(new Menu(browser));
		browser.addLocationListener(new LocationAdapter() {
			@Override
			public void changing(LocationEvent locationEvent) {
			}

			@Override
			public void changed(LocationEvent locationEvent) {
				browser.execute("var mqq = {invoke: function(type, mode, ret){ resultBack(ret.ticket); } };");
				if(locationEvent.location.contains("cap_union_new_show") && ticket[0] == null) {
					// browser.execute("var t,e=location.search,a=document.createElement(\"script\");if(a.type=\"text/javascript\",t=-1==window.location.href.indexOf(\"https\")?\"http://captcha.qq.com/template/TCapIframeApi.js\"+e:\"https://ssl.captcha.qq.com/template/TCapIframeApi.js\"+e,a.src=t,document.getElementsByTagName(\"head\").item(0).appendChild(a),-1!=e.indexOf(\"?\")){var n,c,i=e.substr(1).split(\"&\");try{for(var r=0;r<i.length;r++)\"cap_cd\"==i[r].split(\"=\")[0]&&(n=i[r].split(\"=\")[1]),\"uin\"==i[r].split(\"=\")[0]&&(c=i[r].split(\"=\")[1])}catch(e){}}var o={callback:function(t){ resultBack(t.ticket); if(\"undefined\"!=typeof mqq&&mqq.invoke)0==t.ret?mqq.invoke(\"CAPTCHA\",\"onVerifyCAPTCHA\",{result:\"0\",ticket:t.ticket,randstr:t.randstr}):mqq.invoke(\"CAPTCHA\",\"onVerifyCAPTCHA\",{result:\"1\"});else try{var e=new Image,a=location.href;a=400<a.length?a.substr(0,400):a;var n=\"https://aq.qq.com/cn2/manage/mbtoken/cap_monitor?uid=\"+c+\"&href=\"+encodeURIComponent(a);n+=\"&type=2\",e.src=n}catch(t){}},showHeader:!1,capcd:n};a.onload=function(){capInit(document.getElementById(\"cap_iframe\"),o)}");
					// 该方法需要二次刷新 已废除
					ticket[0] = "ToolQ";
				}
			}
		});

		new BrowserFunction(browser, "resultBack") {
			@Override
			public Object function(Object[] objects) {
				if(objects != null) {
					ticket[0] = (String) objects[0];
					shell.close();
				}
				return null;
			}
		};

		browser.setJavascriptEnabled(true);
		browser.setUrl(input, null, new String[]{
			"Connection: keep-alive",
			"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3",
			"Upgrade-Insecure-Requests:1",
			String.format("User-Agent:Mozilla/5.0 (Linux; Android %s; %s Build/QKQ1.191222.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/77.0.3865.120 MQQBrowser/6.2 TBS/045332 Mobile Safari/537.36 V1_AND_SQ_8.4.10_1506_HDBM_T QQ/8.4.10.4830 NetType/wifi WebP/0.3.0 Pixel/1080 StatusBarHeight/70 SimpleUISwitch/0 QQTheme/1000 InMagicWin/0", Android.machineVersion, Android.machineName),
			"Sec-Fetch-Mode:navigate",
			"Sec-Fetch-User:?1",
			"X-Requested-With:com.tencent.mobileqq",
			"Sec-Fetch-Site:none",
			"Accept-Encoding:gzip, deflate, br",
			"Accept-Language:zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7"
		});
		// browser.setUrl(input);

		shell.pack();
		shell.open();

		long st = System.currentTimeMillis();
		while (!shell.isDisposed()) {
			if (!display.readAndDispatch())
				display.sleep();
			else {
				if(System.currentTimeMillis() - st > 1000 * 60) {
					// 超过一分钟没有滑块则关闭
					shell.close();
					ticket[0] = null;
				}
			}
		}
		display.dispose();
		return ticket[0];
	}

	public static abstract class DeviceLockEvent {
		public boolean isLoaded = false;

		/**
		 * 获取验证码事件
		 */
		public abstract boolean getSMSCode();

		/**
		 * 提交验证码事件
		 *
		 * @param code 验证码
		 */
		public abstract void checkCode(Shell shell, String code);
	}
}
